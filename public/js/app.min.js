"use strict";var Animations={};Animations.tooglePreferencesMenu=function(){var e=document.getElementById("dropdown-toggle");e&&e.addEventListener("click",function(e){e.preventDefault(),this.nextElementSibling.classList.contains("hide")?(this.nextElementSibling.classList.remove("hide"),this.classList.add("dropdown-toggle")):(this.nextElementSibling.classList.add("hide"),this.classList.remove("dropdown-toggle"))},!1)},Animations.toggleSubmenu=function(e){var t=Array.prototype.slice.call(document.querySelectorAll("li.item-submenu > a"));t&&t.forEach(function(e,t){e.addEventListener("click",function(e){e.preventDefault(),this.parentNode.classList.toggle("open")},!0)})},Animations.toggleMenuSecondary=function(e){var t=document.getElementById("toggle-secondary-menu");if(t){var s=t.firstElementChild.lastElementChild,i=document.querySelector(".menu-secondary"),a=document.querySelector(".info-user-container"),n=document.querySelector(".menu-vertical__nav");t.addEventListener("click",function(e){e.preventDefault(),i.classList.toggle("hide"),a.classList.toggle("hide"),n.classList.toggle("hide"),s.classList.contains("icon-chevron-down")?(s.classList.remove("icon-chevron-down"),s.classList.add("icon-chevron-up")):(s.classList.remove("icon-chevron-up"),s.classList.add("icon-chevron-down"))},!1)}},Animations.togglePanel=function(e){var t=document.querySelectorAll('span[data-toggle="panel"]');t&&t.forEach(function(e,t){e.addEventListener("click",function(e){e.preventDefault(),this.classList.contains("icon-chevron-down")?(this.classList.remove("icon-chevron-down"),this.classList.add("icon-chevron-up")):(this.classList.remove("icon-chevron-up"),this.classList.add("icon-chevron-down")),this.parentNode.parentNode.nextElementSibling.classList.toggle("hide")},!1)})},Animations.toggleMainMenu=function(e){var t=Array.prototype.slice.call(document.querySelectorAll('a[data-toggle="main-menu"]')),s=document.querySelector(".sidebar");t.length>0&&t.forEach(function(e,t){e.addEventListener("click",function(e){e.preventDefault(),s.classList.toggle("open"),"hidden"===document.body.style.overflow?document.body.style.overflow="":document.body.style.overflow="hidden"})}),window.addEventListener("resize",function(){this.innerWidth>=768&&(document.body.style.overflow="auto")})},Animations.loader=document.querySelector(".loader"),Animations.loaderMessage=document.querySelector(".loader-message"),Animations.showHideLoader=function(){Animations.loader.classList.contains("show")?Animations.loader.classList.remove("show"):Animations.loader.classList.add("show")},Animations.tabs=function(){var e=[].slice.call(document.querySelectorAll("a.tab-link"));e.forEach(function(e,t){e.addEventListener("click",function(e){if(e.preventDefault(),!this.classList.contains("active")){var t=document.querySelector("a.tab-link.active");document.getElementById(t.getAttribute("data-tab")).classList.remove("active"),t.classList.remove("active"),document.getElementById(this.getAttribute("data-tab")).classList.add("active"),this.classList.add("active")}})})},Animations.toggleMenuSecondary(),Animations.toggleMainMenu(),Animations.toggleSubmenu(),Animations.togglePanel(),Animations.tooglePreferencesMenu(),Animations.tabs();var Events={},_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ajax={};Ajax.headers={form:"application/x-www-form-urlencoded",json:"application/json"},Ajax.State={UNSET:0,OPENED:1,HEADERS_RECEIVED:2,LOADING:3,DONE:4},Ajax.init=function(){return window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP")},Ajax.send=function(e,t,s,i,a,n){var r=Ajax.init();try{if(!e)throw"La url indicada no es valida.";if(!t||null===t||"POST"!==t.toString()&&"GET"!==t.toString()?t="GET":("object"===("undefined"==typeof a?"undefined":_typeof(a))&&"FormData"===a.constructor||"string"!=typeof a)&&(t="POST"),!i||i.constructor!==Function)throw"La función no es valida";if(r.open(t,e,!0),r.setRequestHeader("X-CSRF-TOKEN",document.querySelector('meta[name="csrf-token"]').getAttribute("content")),!n)throw"No se indico el tipo de dato a enviar";switch(n){case"json":r.setRequestHeader("Content-Type","application/json;charset=UTF-8")}if("arraybuffer"!==s&&"blob"!==s&&"document"!==s&&"json"!==s&&"text"!==s)throw"El tipo de respuesta indicado no es valido.";r.responseType=s,r.onreadystatechange=function(){(422===this.status||this.readyState===this.DONE&&200===this.status)&&i(this.response)},r.onprogress=function(){},r.onabort=function(){},r.onerror=function(){},r.send(a)}catch(e){console.log(e)}};var Utilities={};Utilities.checkColorHEX=function(e){return!(!/^(#)+[A-Z0-9]{6}$/.test(e)&&!/^(#)+[A-Z0-9]{3}$/.test(e))},Utilities.checkNameEntities=function(e){return!!/^[A-Za-z-ÁÉÍÓÚÑáéíóúñ0-9\_\&\-\.\'\"\s]{2,60}$/.test(e)},Utilities.checkNumber=function(e){return!!/^\d+$/.test(parseInt(e))},Utilities.regExp={name:/^[A-Za-z-ÁÉÍÓÚÑáéíóúñ\s]{2,60}$/,username:/^[a-z0-9\_]+$/,email:/^([\w_\.\-]{4,60})@(([\w\-]{2,25})+\.)+([\w]{2,20})$/,date:/^(\d{1,2})+\/+(\d{1,2})+\/+(\d{4})$/,password:/^[A-za-z0-9\_\-\!\&]{8, 30}$/},Utilities.Snackbar=function(e,t){var s=document.getElementById("snackbar");document.getElementById("add");s.innerHTML=""!==e?e:"",t=t&&"error"===t?"snackbar-error":"snackbar-success",s.classList.add("show"),s.classList.add(t),setTimeout(function(){s.classList.remove("show"),s.classList.remove(""!==t?t:"")},3e3)},Utilities.DateFormat=function(e){var t=e.split(" "),s=t[0].split("-");return s[2]+"-"+s[1]+"-"+s[0]+" "+t[1]};var Validations={};Validations.messageForm={error_form:"Por favor, Comprueba los errores.",success_form:"Enviado con exito.",required:"El campo es requerido.",error_name:"El nombre ingresado no es valido.",error_value:"El valor ingresado no es valido.",error_description:"La descripción, no debe superar los 250 caracteres.",password:"Utiliza al menos una combinación entre 8 y 30 números, letras, guiones y signos de puntuación (como ! y &).",genre_add:"Genero agregado con exito.",genre_exist:"El género, ya existe.",artist_add:"Artista agregado con exito.",artist_exist:"El artista, ya existe.",album_add:"Album agregado con exito.",album_exist:"El album, ya existe.",quantity_tracks:"El valor ingresado no es valido.",track_add:"Pista agregada con exito.",track_exist:"La pista, ya existe."},Validations.username=function(e){var t={success:!0};return""===e?t={success:!1,message:Validations.messageForm.required}:Utilities.regExp.username.test(e)||(t={success:!1,message:Validations.messageForm.error_name}),t},Validations.name=function(e){var t={success:!0};return""===e?t={success:!1,message:Validations.messageForm.required}:Utilities.regExp.name.test(e)||(t={success:!1,message:Validations.messageForm.error_value}),t},Validations.email=function(e){var t={success:!0};return""===e?t={success:!1,message:Validations.messageForm.required}:Utilities.regExp.email.test(e)||(t={success:!1,message:"El correo ingresado no es valido"}),t},Validations.numberOfDays=function(e,t){return 1!==e||t%4!==0||t%100===0&&t%400!==0?[31,28,31,30,31,30,31,31,30,31,30,31][e]:29},Validations.birthdate=function(e,t,s){var i={success:!0};if(""===e||""===t||""===s)i={success:!1,message:Validations.messageForm.required};else{var a=e+"/"+t+"/"+s;!Utilities.regExp.date.test(a)||parseInt(e)>Validations.numberOfDays(t-1,s)?i={success:!1,message:"La fecha ingresada no es valida"}:(new Date).getFullYear()-s<18&&(i={success:!1,message:"Debe ser mayor de edad."})}return i},Validations.file={},Validations.file.BYTE=1048576,Validations.file.MAX_FILE_SIZE=2,Validations.file.BORDER_COLOR="#00f0ff",Validations.file.mimeType={text:"text/plain",image:{jpg:"image/jpg",jpeg:"image/jpeg",png:"image/png",gif:"image/gif"},audio:{mp3:"audio/mp3",audio_ogg:"audio/ogg",wav:"audio/wav"},video:{mp4:"video/mp4",video_ogg:"video/ogg"}},Validations.file.message={require:"El campo es requerido.",max_size:"El archivo no debe superara los "+Validations.file.MAX_FILE_SIZE+" MB.",invalid_type_file:"Tipo de archivo no permitido.",API_nosupport:"No se pudo generar la vista previa. La API  no esta soportada por tu navegador."},Validations.file.drop_zone="drop-zone",Validations.file.FILES=null,Validations.file.createElements=function(e){var t=document.createElement("H2");t.innerHTML="Arrastra tu archivo aquí",t.classList.add("preview__title");var s=document.createElement("A");s.setAttribute("href","#"),s.setAttribute("id","button-file"),s.classList.add("button"),s.classList.add("button-alice"),s.classList.add("preview__button"),s.innerHTML="Seleccionar archivo";var i=document.createElement("input");i.setAttribute("type","file"),i.setAttribute("name","file"),i.setAttribute("multiple",!1),i.setAttribute("id","file"),i.classList.add("hide");var a=document.createElement("P");a.classList.add("error-uploaded");var n=document.createElement("H4");n.classList.add("name_file"),n.classList.add("hide");var r=document.createElement("DIV");r.classList.add("loading");var o=document.createElement("SPAN");o.classList.add("icon-upload-cloud"),o.classList.add("preview__icon");var l=document.createElement("DIV");l.classList.add("player");var d=document.createElement("DIV");d.classList.add("mask"),e.appendChild(o),e.appendChild(s),e.appendChild(i),e.appendChild(a),e.appendChild(t),e.appendChild(n),l.appendChild(d),e.appendChild(l),e.parentNode.appendChild(r)},Validations.file.upload=function(e,t,s){e=e||Validations.file.drop_zone;var i=document.getElementById(e);s&&Validations.file.createElements(i);var a=document.getElementById("button-file"),n=document.getElementById("file"),r=document.querySelector(".loading"),o=document.querySelector(".name_file"),l=document.querySelector(".error-uploaded"),d=document.querySelector(".preview__icon"),c=i.style.borderColor,u=!1,m=null,p=String(Validations.file.BORDER_COLOR).toUpperCase();if(!Utilities.checkColorHEX(p))return console.log("El color "+p+" no es un color hexadecimal valido."),!1;if(null===t)t="image";else if(t.constructor===Array)t.forEach(function(e,t){Validations.file.mimeType.hasOwnProperty(e)||Validations.file.mimeType.audio.hasOwnProperty(e)||Validations.file.mimeType.video.hasOwnProperty(e)||Validations.file.mimeType.image.hasOwnProperty(e)||console.log("El tipo de mime "+e+" no es valido")});else if(!(Validations.file.mimeType.hasOwnProperty(t)||Validations.file.mimeType.audio.hasOwnProperty(t)||Validations.file.mimeType.video.hasOwnProperty(t)||Validations.file.mimeType.image.hasOwnProperty(t)))return console.log("El tipo de mime indicado no es valido"),!1;var g=Validations.file.MAX_FILE_SIZE*Validations.file.BYTE,f=function(){i.classList.remove("error"),l.innerHTML="",o.innerHTML="",r.style.display="block",r.style.width=0},v=function(e,t){function s(){i+=10,r.style.width=i+"%",i>=100&&(d.classList.remove("alice","zoom"),y(e,t),clearInterval(n))}f();var i=0,a=document.getElementById("preview-element")||null;a&&a.remove(),d.classList.contains("zoom","alice")||d.classList.add("alice","zoom");var n=setInterval(s,180)},h=function(e){for(var s=!0,a=!1,n=0,r=e[0].type,o=Object.keys(Validations.file.mimeType).length;a===!1&&n<o;){if("audio"===t||"video"===t||"image"===t)for(var d in Validations.file.mimeType[t])Validations.file.mimeType[t][d]===r&&(a=!0);else Validations.file.mimeType.audio[t]===r?a=!0:Validations.file.mimeType.video[t]===r?a=!0:Validations.file.mimeType.image[t]===r?a=!0:Validations.file.mimeType[t]===r&&(a=!0);n++}return a?e[0].size>g?(l.innerHTML=Validations.file.message.max_size,s=!1):(l.innerHTML="",s=!0):(l.innerHTML=Validations.file.message.invalid_type_file,s=!1),s||i.classList.add("error"),s},y=function(e,s){if(r.style.display="none",i.style.borderColor=c,m=u?s:e.target.files,0===m.length||m.length>1)l.innerHTML=Validations.file.message.require;else if(h(m))if(Validations.file.FILES=m[0],window.File&&window.FileReader&&window.FileList&&window.Blob){var a=new FileReader,n=null;document.getElementById("preview-element")&&i.removeChild(document.getElementById("preview-element")),"audio"===t||Validations.file.mimeType.audio.hasOwnProperty(t)?(n=document.createElement("AUDIO"),n.setAttribute("controls",!0)):"video"===t||Validations.file.mimeType.video.hasOwnProperty(t)?(n=document.createElement("VIDEO"),n.setAttribute("controls",!0),n.style.width="560px",n.style.height="auto"):"image"===t||Validations.file.mimeType.image.hasOwnProperty(t)?n=document.createElement("IMG"):"text"===t&&(n=document.createElement("DIV")),a.addEventListener("load",function(){n.id="preview-element",o.innerHTML=m[0].name,o.classList.remove("hide"),"text"===t?n.innerHTML=this.result:n.src=this.result,"audio"==t?document.querySelector(".player").appendChild(n):i.appendChild(n),window.document.body.scrollTop=window.document.body.scrollHeight}),"text"===t?a.readAsText(m[0]):a.readAsDataURL(m[0])}else o.innerHTML=m[0].name},L=function(e){e.stopPropagation(),e.preventDefault();var t=e.dataTransfer.files;t.length>0&&(l.innerHTML="",u=!0,v(e,t))},E=function(e){e.stopPropagation(),e.preventDefault(),e.dataTransfer.dropEffect="copy",this.style.borderColor=p,d.classList.add("alice","zoom")},S=function(e){e.stopPropagation(),e.preventDefault(),this.style.borderColor=c,d.classList.remove("alice","zoom")};i.addEventListener("dragover",E,!1),i.addEventListener("drop",L,!1),i.addEventListener("dragleave",S,!1),a.addEventListener("click",function(e){e.preventDefault(),n.click()}),n.addEventListener("change",function(e){u=!1,v(e)})};var Music={};Music.PATHNAME=window.location.pathname,Music.paths={add:/^(\/(genres|artists|albums|tracks)\/add)$/,edit:/^(\/(genres|artists|albums|tracks)\/edit\/)+[0-9]{1,}$/,add_genre:/^(\/genres\/add)$/,add_artist:/^(\/artists\/add)$/,add_album:/^(\/albums\/add)$/,add_track:/^(\/tracks\/add)$/,edit_genre:/^(\/genres\/edit\/)+[0-9]{1,}$/,edit_artist:/^(\/artists\/edit\/)+[0-9]{1,}$/,edit_album:/^(\/albums\/edit\/)+[0-9]{1,}$/,edit_track:/^(\/tracks\/edit\/)+[0-9]{1,}$/},Music.Fields={form:document.getElementById("form-add")||null,delete:document.getElementById("delete-music")||null,deleteAll:document.getElementById("delete-all")||null,name:document.getElementById("nombre")||null,description:document.getElementById("descripcion")||null,select:document.getElementById("select-item")||null,quantity_tracks:document.getElementById("cantidad_pistas")||null,year:document.getElementById("anio")||null,file:document.getElementById("file")||null,btn_add:document.getElementById("music-add")||null,btn_frm:document.getElementById("button-form")||null,drop_zone:document.getElementById("drop-zone")||null,file_error:document.querySelector("p.error-uploaded")||null},Music.HelpBlocks={name:"Utiliza sólo caracteres alfanumericos, guiones, puntos, espacios, comillas y el signo &."},Music.responseServerAdd=function(e){e&&(e.hasOwnProperty("success")&&!e.success?(e.hasOwnProperty("error")&&Utilities.Snackbar(e.error,"error"),e.hasOwnProperty("message")&&e.hasOwnProperty("exist")&&e.exist&&(Music.Fields.name.parentNode.classList.add("error"),Music.Fields.name.nextElementSibling.innerHTML=e.message_exist),e.hasOwnProperty("messages")&&(e.messages.hasOwnProperty("nombre")&&(Music.Fields.name.parentNode.classList.add("error"),Music.Fields.name.nextElementSibling.innerHTML=e.messages.nombre[0]),e.messages.hasOwnProperty("descripcion")&&(Music.Fields.description.parentNode.classList.add("error"),Music.Fields.description.nextElementSibling.innerHTML=e.messages.descripcion[0]),e.messages.hasOwnProperty("select")&&(Music.Fields.select.parentNode.classList.add("error"),Music.Fields.select.nextElementSibling.innerHTML=e.messages.select[0]),e.messages.hasOwnProperty("file")&&(Music.Fields.drop_zone.classList.add("error"),Music.Fields.file_error.innerHTML=e.messages.file[0]))):Music.paths.add.test(Music.PATHNAME)&&Music.resetForm(!0),e.hasOwnProperty("message")&&(Utilities.Snackbar(e.message),Animations.loaderMessage.innerHTML="",Animations.showHideLoader(),Music.paths.edit.test(location.pathname)&&(Music.Fields.name.value=e.name,e.description&&(Music.Fields.description.value=e.description),e.select&&Music.Fields.select.querySelector('option[value="'+e.select+'"]').setAttribute("selected","true"),""!==e.src&&(document.getElementById("preview-element").firstElementChild.src="http://thermobackend.com/storage/"+e.src+"?r="+Math.floor(1e3*Math.random())))))},Music.uploadToServer=function(){var e=null,t=window.location.href;e=new FormData,e.append("nombre",Music.Fields.name.value),e.append("descripcion",null!==Music.Fields.description?Music.Fields.description.value:""),e.append("select",null!==Music.Fields.select?Music.Fields.select.value:""),e.append("file",Validations.file.FILES),e.append("cant_pistas",Music.Fields.quantity_tracks?Music.Fields.quantity_tracks.value:""),e.append("anio",Music.Fields.year?Music.Fields.year.value:""),Music.paths.edit.test(Music.PATHNAME)&&(t=t.replace("edit","update")),Animations.loaderMessage.innerHTML="Procesando solicitud...",Animations.showHideLoader(),Ajax.send(t,"POST","json",Music.responseServerAdd,e,"FormData")},Music.resetForm=function(e){var t=Music.Fields.name,s=Music.Fields.description,i=Music.Fields.select,a=Music.Fields.quantity_tracks,n=Music.Fields.year;if(Music.Fields.drop_zone.classList.remove("error"),Music.Fields.drop_zone.classList.remove("success"),t.parentNode.classList.remove("error"),t.nextElementSibling.innerHTML="",i&&(i.parentNode.classList.remove("error"),i.nextElementSibling.innerHTML=""),s&&s.parentNode.classList.remove("error"),a&&(a.parentNode.classList.remove("error"),a.nextElementSibling.innerHTML=""),n&&(n.parentNode.classList.remove("error"),n.nextElementSibling.innerHTML=""),e){var r=document.getElementById("preview-element"),o=document.querySelector(".name_file");Music.Fields.form.reset(),Validations.file.FILES=null,r&&("DIV"===r.tagName?r.innerHTML="":r.src="",r.parentNode.removeChild(r)),o&&(o.innerHTML="")}},Music.add=function(e){e.preventDefault();var t=!0,s=Music.Fields.drop_zone,i=(Music.Fields.file_error,Music.Fields.name),a=Music.Fields.description,n=Music.Fields.select,r=(Music.Fields.form,Music.Fields.quantity_tracks),o=Music.Fields.year;i.value=i.value.trim(),Music.resetForm(),""===i.value?(t=!1,i.parentNode.classList.add("error"),i.nextElementSibling.innerHTML=Validations.messageForm.required):Utilities.checkNameEntities(i.value)||(t=!1,i.parentNode.classList.add("error"),i.nextElementSibling.innerHTML=Music.HelpBlocks.name),null!==n&&""===n.selectedOptions[0].value&&(t=!1,n.parentNode.classList.add("error"),n.nextElementSibling.innerHTML=Validations.messageForm.required),null!==a&&a.value.length>250&&(t=!1,a.parentNode.classList.add("error"),a.nextElementSibling.innerHTML=Validations.messageForm.error_description),null!==r&&(""===r.value?(t=!1,r.parentNode.classList.add("error"),r.nextElementSibling.innerHTML=Validations.messageForm.required):Utilities.checkNumber(r.value)||(t=!1,r.parentNode.classList.add("error"),r.nextElementSibling.innerHTML=Validations.messageForm.quantity_tracks)),null!==o&&""===o.value&&(t=!1,o.parentNode.classList.add("error"),o.nextElementSibling.innerHTML=Validations.messageForm.required),null===Validations.file.FILES&&Music.paths.add.test(Music.PATHNAME)&&(s.classList.add("error"),t=!1),t?Music.uploadToServer():Utilities.Snackbar(Validations.messageForm.error_form,"error")},Music.addEvent=function(){var e=!1,t="image";(Music.paths.add_track.test(Music.PATHNAME)||Music.paths.edit_track.test(Music.PATHNAME))&&(Validations.file.MAX_FILE_SIZE=20,t="audio"),Music.paths.add.test(Music.PATHNAME)&&(e=!0),Validations.file.upload("drop-zone",t,e),Music.Fields.btn_add.addEventListener("click",Music.add)},Music.checkAll=function(){var e=Array.prototype.slice.call(document.querySelectorAll('input[data-music="true"]')),t=Array.prototype.slice.call(document.querySelectorAll('input[data-music="true"]:checked')),s=0,i=0;if(t.length>0)for(s=t.length,i=0;i<s;i++)t[i].checked=!1;s=0,this.checked?e.forEach(function(e,t){e.checked?e.setAttribute("checked","true"):e.checked=!0,s++}):e.forEach(function(e,t){e.removeAttribute("checked")}),s>0?Music.Fields.delete.classList.contains("hide")&&Music.Fields.delete.classList.remove("hide"):Music.Fields.delete.classList.contains("hide")||Music.Fields.delete.classList.add("hide")},Music.selectItemDelete=function(){var e=Array.prototype.slice.call(document.querySelectorAll('input[data-music="true"]')),t=0;e.forEach(function(e,s){e.checked&&t++}),t>0?Music.Fields.delete.classList.contains("hide")&&Music.Fields.delete.classList.remove("hide"):(Music.Fields.deleteAll.checked=!1,Music.Fields.delete.classList.contains("hide")||Music.Fields.delete.classList.add("hide"))},Music.responseServerDelete=function(e){e.hasOwnProperty("success")&&(e.success?window.location.reload():(Utilities.Snackbar(e.message,"error"),Animations.showHideLoader(),Animations.loaderMessage.innerHTML=""))},Music.delete=function(e){e.preventDefault();var t=Array.prototype.slice.call(document.querySelectorAll('input[data-music="true"]:checked')),s=t.length;if(0===s)this.classList.add("hide"),Utilities.Snackbar("Por favor, Selecciona un elemento de la lista.","error");else{var i={};i.items=[],t.forEach(function(e,t){i.items.push(e.value)}),Animations.loaderMessage.innerHTML="Procesando solicitud...",Animations.showHideLoader(),Ajax.send(location.pathname+"/delete","POST","json",Music.responseServerDelete,JSON.stringify(i),"json")}},Music.addEventDelete=function(){[].slice.call(document.querySelectorAll('input[data-music="true"]')).forEach(function(e,t){e.addEventListener("click",Music.selectItemDelete)}),Music.Fields.deleteAll&&Music.Fields.delete&&(Music.Fields.deleteAll.addEventListener("change",Music.checkAll),Music.Fields.delete.addEventListener("click",Music.delete))},function(e,t){Music.Fields.form&&Music.Fields.form.addEventListener("submit",function(e){e.preventDefault(),Music.Fields.btn_add.click()}),Music.paths.add.test(Music.PATHNAME)||Music.paths.edit.test(Music.PATHNAME)?Music.addEvent():Music.addEventDelete()}(window,document);var Search={};Search.Fields={form:document.getElementById("form-search")||null,input:document.getElementById("filter")||null,table:document.querySelector(".table")||null,limit:document.getElementById("limit")||null,panel_left:document.querySelector("#panel-options > .panel-options__left")||null,pagination:document.querySelector("#panel-options > .panel-options__right")||null,tbody:document.getElementById("tbody")||null},Search.addFilter=function(e,t){var s=[].slice.apply(document.querySelectorAll("ul.pagination a"));s.length>0&&s.forEach(function(s,i){var a=s.href.split(window.location.pathname);2===a.length&&(a[1].search("&filter")===-1&&(s.href+="&filter="+e),a[1].search("&limit")===-1&&(s.href+="&limit="+t))})},Search.responseServer=function(e){if(e.hasOwnProperty("data")){var t=Search.Fields.tbody;if(t.innerHTML="",e.hasOwnProperty("entitie"))if(0===e.data.data.length)Search.Fields.table.style.display="none",Search.Fields.panel_left.innerHTML="<h3>No hay resultados disponibles</h3>",Search.Fields.pagination.innerHTML="";else{Search.Fields.table.style.display="table",Search.Fields.panel_left.innerHTML=e.message_panel,Search.Fields.pagination.innerHTML=e.pagination,Search.addFilter(e.filter,e.limit);var s=[].slice.call(document.querySelectorAll("ul.pagination a"));if(s.forEach(function(e,t){e.href=e.href.replace("search","")}),"user"!==e.entitie){var i=e.entitie,a=null,n=null,r=null;switch(i){case"genre":n="nombre_genero",a="id_genero",r="/genres/edit/";break;case"artist":n="nombre_artista",a="id_artista",r="/albums/list/";break;case"album":n="nombre",a="id_album",r="/tracks/";break;default:a=null,n=null,r=null}e.data.data.forEach(function(e,s){var o=null,l=null,d=r+e[a],c=Utilities.DateFormat(e.created_at),u=Utilities.DateFormat(e.updated_at);o="<td>"+(s+1)+"</td><td><a href='"+d+"'>"+e[n]+"</a></td>","artist"!==i&&"album"!==i||("artist"===i?(l="/genres/edit/"+e.id_genero,o+="<td><a href='"+l+"'>"+e.nombre_genero+"</a></td>"):"album"===i&&(l="/artists/edit/"+e.id_artista,o+="<td><a href='"+l+"'>"+e.nombre_artista+"</a></td>")),o+="<td>"+c+"</td><td>"+u+"</td>","artist"!==i&&"album"!==i||("artist"===i?l="/artist/edit/"+e[a]:"album"===i&&(l="albums/edit/"+e[a]),o+="<td><a href='"+l+"'><i class='icon-edit'><i/></a></td>"),o+="<td class='center'><input type='checkbox' name='"+e[n]+"' data-music='true' value='"+e[a]+"'></td>",t.innerHTML+="<tr>"+o+"</tr>"}),Music.addEventDelete()}else e.data.data.forEach(function(e,s){var i=e.nombre?e.nombre:"-",a=e.apellido?e.apellido:"-",n=e.fecha_nac?e.fecha_nac:"-",r=e.created_at?Utilities.DateFormat(e.created_at):"-",o=e.updated_at?Utilities.DateFormat(e.updated_at):"-";t.innerHTML+="<tr><td>"+(s+1)+"</td><td>"+e.usuario+"</td><td>"+e.nombre_tipo+"</td><td>"+i+"</td><td>"+a+"</td><td>"+e.correo+"</td><td>"+n+"</td><td>"+e.sexo+"</td><td>"+r+"</td><td>"+o+"</td><td class='center'><input type='checkbox' name='"+e.usuario+"' data-user='true' value='"+e.id_usuario+"'></td></tr>"}),User.addEventDelete()}}},Search.filter=function(e){var t=(Search.Fields.form,Search.Fields.input.value.trim()),s=null,i=Search.Fields.limit.value?Search.Fields.limit.value:10,a=e.keyCode||e.which;16!==a&&17!==a&&18!==a&&225!==a&&13!==a&&(s=8==a?t:t.length>0?t+String.fromCharCode(a):String.fromCharCode(a),Search.sendForm(s.trim(),i))},Search.sendForm=function(e,t){var s=new FormData;s.append("filter",e),s.append("limit",t),Ajax.send(location.pathname+"/search","POST","json",Search.responseServer,s,"FormData")},function(e){Search.Fields.input&&Search.addFilter(Search.Fields.input.value?Search.Fields.input.value:" ",Search.Fields.limit.value),Search.Fields.input&&(Search.Fields.input.addEventListener("keydown",Search.filter,!1),Search.Fields.form.addEventListener("submit",function(e){e.preventDefault()},!1)),Search.Fields.limit&&Search.Fields.limit.addEventListener("change",function(){Search.sendForm(Search.Fields.input.value?Search.Fields.input.value:"",this.value)})}(document);var User={};User.Fields={form:document.getElementById("form-user")||null,form_change_image:document.getElementById("form-change-image")||null,form_change_password:document.getElementById("form-change-password")||null,drop_zone:document.getElementById("drop-zone")||null,error_uploaded:document.querySelector(".error-uploaded")||null,username:document.getElementById("usuario")||null,account:document.getElementById("cuenta")||null,name:document.getElementById("nombre")||null,lastname:document.getElementById("apellido")||null,email:document.getElementById("correo")||null,sex:document.getElementById("sexo")||null,day:document.getElementById("day")||null,month:document.getElementById("month")||null,year:document.getElementById("year")||null,password:document.getElementById("pass")||null,confirm_password:document.getElementById("confirm_password")||null,items_delete:document.querySelectorAll('input[data-user="true"]')||null,delete:document.getElementById("delete-user")||null},User.resetForm=function(e){var t=[].slice.call(document.querySelectorAll(".input"));document.getElementById("tooltip-date").classList.remove("show"),t.forEach(function(e,t){e.classList.contains("error")&&(e.classList.remove("error"),e.classList.contains("select")||(e.previousElementSibling.innerHTML="",e.previousElementSibling.classList.remove("show")))})},User.responseServerAdd=function(e){if(e.hasOwnProperty("success"))if(e.success){var t=null;"/users/add"===location.pathname?t="Usuario Registrado con exito. <span class='icon-check'></span>":"/users/edit"===location.pathname&&(t="Cuenta actualizada con exito. <span class='icon-check'></span>"),Utilities.Snackbar(t),User.Fields.form.reset(),Animations.loaderMessage.innerHTML="",Animations.showHideLoader()}else if(e.hasOwnProperty("messages"))for(var s in e.messages)User.Fields[s].classList.add("error"),User.Fields[s].previousElementSibling.innerHTML=e.messages.username,User.Fields[s].previousElementSibling.classList.add("show")},User.add=function(){var e=User.Fields.username,t=User.Fields.account,s=User.Fields.name,i=User.Fields.lastname,a=User.Fields.day,n=User.Fields.month,r=User.Fields.year,o=document.getElementById("tooltip-date"),l=User.Fields.email,d=User.Fields.sex,c=(User.Fields.password,User.Fields.confirm_password,!0),u=null;if(User.resetForm(),u=Validations.username(e.value.toLowerCase().trim()),u.success||(e.classList.add("error"),e.previousElementSibling.classList.add("show"),e.previousElementSibling.innerHTML=u.message,c=!1),t&&""===t.value&&(t.classList.add("error"),t.previousElementSibling.classList.add("show"),t.previousElementSibling.innerHTML=Validations.messageForm.required,c=!1),u=Validations.name(s.value.trim()),u.success||(s.classList.add("error"),s.previousElementSibling.classList.add("show"),s.previousElementSibling.innerHTML=u.message,c=!1),u=Validations.name(i.value.trim()),u.success||(i.classList.add("error"),i.previousElementSibling.classList.add("show"),i.previousElementSibling.innerHTML=u.message,c=!1),u=Validations.birthdate(a.value,n.value,r.value),u.success||(a.classList.add("error"),n.classList.add("error"),r.classList.add("error"),o.classList.add("show"),o.innerHTML=u.message,c=!1),u=Validations.email(l.value.toLowerCase().trim()),u.success||(l.classList.add("error"),l.previousElementSibling.classList.add("show"),l.previousElementSibling.innerHTML=u.message,c=!1),""===d.value&&(d.classList.add("error"),d.previousElementSibling.classList.add("show"),d.previousElementSibling.innerHTML=Validations.messageForm.required,c=!1),c){var m=new FormData(User.Fields.form),p="/users/edit"===location.pathname?location.href.replace("edit","update"):location.pathname;Animations.loaderMessage.innerHTML="Procesando solicitud...",Animations.showHideLoader(),Ajax.send(p,"POST","json",User.responseServerAdd,m,"FormData")}else Utilities.Snackbar("Por favor, Comprueba los errores.","error")},User.addEventDelete=function(){User.Fields.items_delete&&([].slice.call(document.querySelectorAll('input[data-user="true"]')).forEach(function(e,t){e.addEventListener("click",User.selectItemDelete)}),User.Fields.delete&&User.Fields.delete.addEventListener("click",User.delete))},User.selectItemDelete=function(){var e=Array.prototype.slice.call(document.querySelectorAll('input[data-user="true"]')),t=0;e.forEach(function(e,s){e.checked&&t++}),t>0?User.Fields.delete.classList.contains("hide")&&User.Fields.delete.classList.remove("hide"):User.Fields.delete.classList.contains("hide")||User.Fields.delete.classList.add("hide")},User.responseServerDelete=function(e){e.hasOwnProperty("success")&&(e.success?window.location.reload():(Utilities.Snackbar(e.hasOwnProperty("message")?e.message:"Lo sentimos, ocurrio un error","error"),Animations.loaderMessage.innerHTML="",Animations.showHideLoader()))},User.delete=function(e){e.preventDefault();var t=Array.prototype.slice.call(document.querySelectorAll('input[data-user="true"]:checked')),s=t.length;if(0===s)this.classList.add("hide"),Utilities.Snackbar("Por favor, selecciona un usuario.","error");else{var i={};i.items=[],t.forEach(function(e,t){i.items.push(e.value)}),Animations.loaderMessage.innerHTML="Procesando solicitud...",Animations.showHideLoader(),Ajax.send(location.href+"/delete","POST","json",User.responseServerDelete,JSON.stringify(i),"json")}},User.responseServerUpdate=function(e){e.hasOwnProperty("success")&&(Animations.loaderMessage.innerHTML="",Animations.showHideLoader(),e.success?(Utilities.Snackbar("Imágen cambiada con éxito. <span class='icon-check'></span>"),setTimeout(function(){window.location.reload()},2e3)):e.hasOwnProperty("message")&&(User.Fields.drop_zone.classList.add("error"),Utilities.Snackbar(e.message,"error")))},User.changeImage=function(){var e=!0;if(User.Fields.drop_zone.classList.remove("error"),null===Validations.file.FILES&&(User.Fields.drop_zone.classList.add("error"),e=!1),e){var t=new FormData,s="/users/edit"===location.pathname?location.href.replace("edit","updateimage"):location.pathname;
t.append("file",Validations.file.FILES),Animations.loaderMessage.innerHTML="Procesando solicitud...",Animations.showHideLoader(),Ajax.send(s,"POST","json",User.responseServerUpdate,t,"FormData")}else Utilities.Snackbar(Validations.messageForm.error_form,"error")},User.responseServerChangePassword=function(e){if(e.hasOwnProperty("success"))if(Animations.showHideLoader(),e.success)Utilities.Snackbar(e.message+"<span class='icon-check'></span>"),User.Fields.form_change_password.reset();else if(e.hasOwnProperty("messages"))for(var t in e.messages)document.getElementById(t).classList.add("error"),document.getElementById(t).nextElementSibling.innerHTML=e.messages[t][0]},User.changePassword=function(){var e=document.getElementById("current_password"),t=document.getElementById("new_password"),s=document.getElementById("confirm_password"),i=!0,a=[].slice.call(document.querySelectorAll('input[type="password"]'));if(a.forEach(function(e,t){e.classList.remove("error"),e.nextElementSibling.innerHTML=""}),""===e.value&&(e.classList.add("error"),e.nextElementSibling.innerHTML=Validations.messageForm.required,i=!1),""===t.value?(t.classList.add("error"),t.nextElementSibling.innerHTML=Validations.messageForm.required,i=!1):!/([A-Za-z\_\.\-]+\d+\W+)/gi.test(t.value)&&(t.value.length<8||t.value.length>30)&&(t.classList.add("error"),t.nextElementSibling.innerHTML="Utiliza entre 8 y 30 caracteres, incluyendo letras, números y signos de puntuación (ejemplo & y -).",i=!1),""===s.value?(s.classList.add("error"),s.nextElementSibling.innerHTML=Validations.messageForm.required,i=!1):s.value!==t.value&&(s.classList.add("error"),s.nextElementSibling.innerHTML="La contraseña no coincide.",i=!1),i){var n=new FormData(User.Fields.form_change_password),r="/users/edit"===location.pathname?location.href.replace("edit","changepassword"):location.pathname;Animations.showHideLoader(),Ajax.send(r,"POST","json",User.responseServerChangePassword,n,"FormData")}else Utilities.Snackbar("Por favor, Comprueba los errores.","error")},function(e){var t=e.getElementById("add");User.Fields.form&&User.Fields.form.addEventListener("submit",function(e){e.preventDefault(),t.click()}),User.Fields.form_change_image&&(Validations.file.MAX_FILE_SIZE=8,Validations.file.upload("drop-zone","image",!0),User.Fields.form_change_image.addEventListener("submit",function(e){e.preventDefault(),User.changeImage()})),User.Fields.form_change_password&&User.Fields.form_change_password.addEventListener("submit",function(e){e.preventDefault(),User.changePassword()}),t&&t.addEventListener("click",function(e){e.preventDefault(),User.Fields.form&&User.add()}),User.addEventDelete()}(document);var Advertising={};Advertising.Fields={form:document.getElementById("form-advertising")||null,name:document.getElementById("name")||null,type:document.getElementById("type-advetising")||null,btn_file:document.querySelector("#button-file")||null,error_file:document.querySelector(".error-uploaded")||null},Advertising.responseServerAdd=function(e){if(console.log(e),e.hasOwnProperty("success"))if(e.success){var t="/advertising/add"===window.location.pathname?"Publicidad agregada con éxito.":"Publicidad actualizada con éxito.";Utilities.Snackbar(t),setTimeout(function(){"/advertising/add"===window.location.pathname&&(Advertising.Fields.form.reset(),window.location.reload())},2e3)}else if(e.hasOwnProperty("messages"))for(var s in e.messages)User.Fields[s].classList.add("error"),User.Fields[s].nextElementSibling.innerHTML=e.messages[s][0],User.Fields[s].nextElementSibling.classList.add("show");else e.hasOwnProperty("message")&&Utilities.Snackbar(e.smessage,"error")},Advertising.add=function(e){e.preventDefault();var t=!0,s=Advertising.Fields.name,i=Advertising.Fields.type;if([].slice.call(document.querySelectorAll(".input")).forEach(function(e,t){e.classList.remove("error"),e.nextElementSibling.innerHTML=""}),""===s.value&&(s.classList.add("error"),s.nextElementSibling.innerHTML=Validations.messageForm.required),""===i.value&&"/advertising/add"===location.pathname&&(i.classList.add("error"),i.nextElementSibling.innerHTML=Validations.messageForm.required),null===Validations.file.FILES&&"/advertising/add"===location.pathname&&(document.getElementById("drop-zone").classList.add("error"),t=!1),t){var a="/advertising/add"===window.location.pathname?window.location.pathname:window.location.pathname.replace("edit","update"),n=new FormData(Advertising.Fields.form);n.append("file",Validations.file.FILES),Ajax.send(a,"POST","json",Advertising.responseServerAdd,n,"FormData")}else Utilities.Snackbar(Validations.messageForm.error_form,"error")},Advertising.selectedItemsDelete=function(){var e=document.getElementById("delete-advertising"),t=Array.prototype.slice.call(document.querySelectorAll('input[data-advertising="true"]')),s=0;t.forEach(function(e,t){e.checked&&s++}),s>0?e.classList.contains("hide")&&e.classList.remove("hide"):e.classList.contains("hide")||e.classList.add("hide")},Advertising.responseServerDelete=function(e){e.hasOwnProperty("success")&&(e.success?window.location.reload():Utilities.Snackbar(e.message,"error"))},Advertising.delete=function(e){e.preventDefault();var t=Array.prototype.slice.call(document.querySelectorAll('input[data-advertising="true"]:checked')),s=t.length;if(0===s)this.classList.add("hide"),Utilities.Snackbar("Por favor, Selecciona un elemento de la lista.","error");else{var i={};i.items=[],t.forEach(function(e,t){i.items.push(e.value)}),Ajax.send(window.location.pathname+"/delete","POST","json",Advertising.responseServerDelete,JSON.stringify(i),"json")}},function(e){if(Advertising.Fields.form)Advertising.Fields.form.addEventListener("submit",Advertising.add),Advertising.Fields.type.addEventListener("change",function(){this.nextElementSibling.innerHTML="",this.classList.remove("error"),document.getElementById("drop-zone").innerHTML="",""===this.value?(this.nextElementSibling.innerHTML=Validations.messageForm.required,this.classList.add("error")):(Validations.file.MAX_FILE_SIZE=20,Validations.file.upload("drop-zone",this.value,!0),document.getElementById("drop-zone").parentNode.classList.remove("hide"))});else if("/advertising"===window.location.pathname){var t=Array.prototype.slice.call(document.querySelectorAll('input[data-advertising="true"]'));t.forEach(function(e,t){e.addEventListener("change",Advertising.selectedItemsDelete)}),document.getElementById("delete-advertising").addEventListener("click",Advertising.delete)}}(document);var Task={};Task.Fields={form:document.getElementById("form-task")||null,title:document.getElementById("titlek")||null,task:document.getElementById("task")||null,todo_list:document.getElementById("todo-list")||null,delete:document.getElementById("delete-task")||null,error_message:document.getElementById("error-message-task")||null},Task.responseServerCreate=function(e){if(e.hasOwnProperty("success"))if(e.success){var t=document.createElement("li"),s=document.createElement("a"),i=document.createTextNode(e.task.title.length>20?e.task.title.substring(0,18)+"...":e.task.title),a=document.createElement("span");a.classList.add("icon-check"),s.setAttribute("href","#"),s.setAttribute("data-task",e.task.id),s.appendChild(a),s.appendChild(i),t.classList.add("todo-list__item"),t.appendChild(s),0===Task.Fields.todo_list.children.length?Task.Fields.todo_list.appendChild(t):Task.Fields.todo_list.insertBefore(t,Task.Fields.todo_list.firstElementChild),Task.AddEventOK(),document.getElementById("todo-list-container").parentNode.classList.remove("hide"),Task.Fields.form.reset()}else if(e.hasOwnProperty("messages"))for(var n in e.messages)Task.Fields[n].classList.add("error"),Task.Fields[n].parentNode.nextElementSibling.innerHTML=e.messages[n][0]},Task.create=function(e){e.preventDefault();var t=!0,s=document.getElementById("title");document.getElementById("task");if(s.classList.remove("error"),s.parentNode.nextElementSibling.innerHTML="",Task.Fields.error_message.innerHTML="",""===s.value&&(s.classList.add("error"),s.parentNode.nextElementSibling.innerHTML=Validations.messageForm.required,t=!1),t){var i=new FormData(Task.Fields.form);Ajax.send("/task/create","POST","json",Task.responseServerCreate,i,"FormData")}},Task.responseServerDelete=function(e){if(e.hasOwnProperty("success")){var t=[].slice.call(document.querySelectorAll(".todo-list__item.active"));e.success?t.forEach(function(e,t){Task.Fields.todo_list.removeChild(e)}):(Task.Fields.error_message.innerHTML=e.message,t.forEach(function(e,t){e.classList.remove("active")}))}},Task.delete=function(e){var t=this;e.preventDefault();var s=[].slice.call(document.querySelectorAll(".todo-list__item.active a"));Task.Fields.error_message.innerHTML="",s.length>0&&!function(){var e=(new FormData,{});e.tasks=[],s.forEach(function(t,s){e.tasks.push(t.getAttribute("data-task"))}),t.classList.add("hide"),Ajax.send("/task/delete","POST","json",Task.responseServerDelete,JSON.stringify(e),"json")}()},Task.taskOk=function(e){e.preventDefault(),this.parentNode.classList.toggle("active"),Task.Fields.error_message.innerHTML="";var t=document.querySelectorAll(".todo-list__item.active").length;t>0?Task.Fields.delete.classList.contains("hide")&&Task.Fields.delete.classList.remove("hide"):Task.Fields.delete.classList.contains("hide")||Task.Fields.delete.classList.add("hide")},Task.AddEventOK=function(){var e=[].slice.call(document.querySelectorAll(".todo-list__item a"));e.length>0&&e.forEach(function(e,t){e.removeEventListener("click",Task.taskOk,!1),e.addEventListener("click",Task.taskOk,!1)})},function(e){var t=document.getElementById("form-task");t&&t.addEventListener("submit",Task.create),Task.Fields.delete&&Task.Fields.delete.addEventListener("click",Task.delete),Task.AddEventOK()}(document);